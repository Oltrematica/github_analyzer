# Implementation Plan: Smart Repository Filtering

**Branch**: `005-smart-repo-filter` | **Date**: 2025-11-29 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/005-smart-repo-filter/spec.md`

## Summary

Add smart repository filtering to display activity statistics ("N repos found, M with activity in last X days") and automatically filter repositories based on recent push activity using the GitHub Search API. This extends Feature 004's interactive selection by showing only active repositories by default, with option to include inactive ones.

## Technical Context

**Language/Version**: Python 3.9+ (per constitution, leveraging type hints)
**Primary Dependencies**: Standard library (urllib, json); optional: requests (already in codebase)
**Storage**: N/A (in-memory filtering during selection)
**Testing**: pytest with mocking (existing pattern)
**Target Platform**: CLI (macOS, Linux, Windows)
**Project Type**: Single project (extending existing modular structure)
**Performance Goals**: Filter 500+ repos within 5 seconds (SC-001: stats visible in 5s)
**Constraints**: GitHub Search API rate limit: 30 requests/minute authenticated
**Scale/Scope**: Support orgs with 500+ repos (SC-005)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Modular Architecture | ✅ PASS | Extends `api/client.py` with search method, updates `cli/main.py` |
| II. Security First | ✅ PASS | Uses existing token handling; no new secrets; search API uses same auth |
| III. Test-Driven Development | ✅ PASS | Tests required before implementation per spec |
| IV. Configuration over Hardcoding | ✅ PASS | Uses existing `--days` parameter; no new hardcoded values |
| V. Graceful Error Handling | ✅ PASS | FR-008 specifies rate limit fallback; FR-009 handles zero results |
| API Client Standards | ✅ PASS | Search API uses existing retry/timeout logic |

**Gate Status**: PASSED - No violations to justify.

## Project Structure

### Documentation (this feature)

```text
specs/005-smart-repo-filter/
├── plan.md              # This file
├── research.md          # GitHub Search API research
├── data-model.md        # Activity filter entities
├── quickstart.md        # Usage guide
├── contracts/           # Search API contract
│   └── search-api.md
├── checklists/
│   └── requirements.md  # Spec quality checklist
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
src/github_analyzer/
├── api/
│   └── client.py        # Add search_repos() and search_active_org_repos() methods
├── cli/
│   └── main.py          # Extend select_github_repos() with filtering
├── config/
│   └── settings.py      # Already has 'days' parameter
└── core/
    └── exceptions.py    # Existing error classes

tests/
├── unit/
│   └── api/
│       └── test_client.py    # Add search API tests
└── integration/
    └── test_smart_filter.py  # New file for activity filtering tests
```

**Structure Decision**: Single project extending existing modular architecture. No new modules needed - this feature adds a method to GitHubClient and enhances select_github_repos().

## Complexity Tracking

> No violations detected - table not required.
